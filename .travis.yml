language: python
python:
    - "2.6"
    - "2.7"
    - "3.2"
    - "3.3"
    - "3.4"
    - "3.5"
    - "3.5-dev"
    - "3.6-dev"
    - pypy
    - pypy3


# ===== testing systems =====

os:
    - linux

#compiler:
#   - g++
#   - clang

matrix:
    allow_failures:
        - python: pypy
        - python: pypy3
        - python: 3.5-dev
        - python: 3.6-dev
        - os: osx
    include:
        - os: osx
          language: generic

# ===== install dependencies =====

before_install:
    - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo sh .before_install_linux.sh ; fi
    - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then sh .before_install_osx.sh          ; fi

# all
install:
    - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo sh .install_linux.sh        ; fi
    - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then sh .install_osx.sh                 ; fi
    - if [[ "$TRAVIS_PYTHON_VERSION" == 2.* ]]; then .install_python2.sh           ; fi
    - if [[ "$TRAVIS_PYTHON_VERSION" == pypy ]]; then .install_python2.sh          ; fi
    - if [[ "$TRAVIS_PYTHON_VERSION" == 3.* ]]; then .install_python3.sh           ; fi
    - if [[ "$TRAVIS_PYTHON_VERSION" == pypy3 ]]; then .install_python3.sh         ; fi

# ubuntu
addons:
    apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - libglew-dev
        - libsoil-dev
        - libglm-dev

# ===== run tests =====

# Run tests individually
#env:
#    - TEST_SUITE=core
#    - TEST_SUITE=graphics
#    - TEST_SUITE=gui
#    - TEST_SUITE=input
#    - TEST_SUITE=physics
#    - TEST_SUITE=prototypes
#    - TEST_SUITE=sound
#script: "make test-$TEST_SUITE"

# Run all tests at once
script: "make test-all"

